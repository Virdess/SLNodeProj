(function(_0x41b397,_0x3e925f){const _0xa01dc1=_0x1354,_0x578bb2=_0x41b397();while(!![]){try{const _0x4099a4=-parseInt(_0xa01dc1(0x1e2))/0x1+parseInt(_0xa01dc1(0x1e9))/0x2+parseInt(_0xa01dc1(0x1d1))/0x3+-parseInt(_0xa01dc1(0x1dd))/0x4*(parseInt(_0xa01dc1(0x1e1))/0x5)+-parseInt(_0xa01dc1(0x1dc))/0x6*(-parseInt(_0xa01dc1(0x1cd))/0x7)+-parseInt(_0xa01dc1(0x1ca))/0x8+parseInt(_0xa01dc1(0x1cc))/0x9*(parseInt(_0xa01dc1(0x1e5))/0xa);if(_0x4099a4===_0x3e925f)break;else _0x578bb2['push'](_0x578bb2['shift']());}catch(_0x2b476f){_0x578bb2['push'](_0x578bb2['shift']());}}}(_0x3e0c,0xbd001));function _0x3e0c(){const _0x38df02=['30d','json','log','Неверный\x20логин\x20или\x20пароль','updateOne','94572PJsflL','32956BZvayo','userID','genSalt','body','430Gwtmdb','1331041kXdldB','Не\x20удалось\x20произвести\x20авторизацию','email','7491580CZfSZO','save','userName','Попытка\x20входа\x20не\x20удалась','2742112XUDpOj','_id','Пользователь\x20не\x20найден','sign','5691976UjFBnI','password','9TCEDNo','42xAhEsT','status','compare','findById','3931353BVxIGz','_doc','passwordHash','avatarUrl','Не\x20удалось\x20зарегистрироваться','findOne'];_0x3e0c=function(){return _0x38df02;};return _0x3e0c();}import _0x5ae0c4 from'jsonwebtoken';import _0x1c5f0a from'bcrypt';function _0x1354(_0x1dd9f6,_0x1a6fd0){const _0x3e0cf7=_0x3e0c();return _0x1354=function(_0x1354b2,_0x1e3de4){_0x1354b2=_0x1354b2-0x1c9;let _0x14671f=_0x3e0cf7[_0x1354b2];return _0x14671f;},_0x1354(_0x1dd9f6,_0x1a6fd0);}import _0x4fa4d3 from'../../models/UserModels/User.js';export const register=async(_0x46e499,_0x3c32fe)=>{const _0x20dc66=_0x1354;try{const _0x1b7586=_0x46e499[_0x20dc66(0x1e0)][_0x20dc66(0x1cb)],_0x1c4374=await _0x1c5f0a[_0x20dc66(0x1df)](0xa),_0x433e91=await _0x1c5f0a['hash'](_0x1b7586,_0x1c4374),_0x291f6b=new _0x4fa4d3({'email':_0x46e499[_0x20dc66(0x1e0)][_0x20dc66(0x1e4)],'userName':_0x46e499[_0x20dc66(0x1e0)]['userName'],'avatarUrl':_0x46e499[_0x20dc66(0x1e0)][_0x20dc66(0x1d4)],'role':_0x46e499['body']['role'],'passwordHash':_0x433e91}),_0x4e6c63=await _0x291f6b[_0x20dc66(0x1e6)](),_0x111fbd=_0x5ae0c4[_0x20dc66(0x1c9)]({'_id':_0x4e6c63['_id'],'username':_0x4e6c63[_0x20dc66(0x1e7)]},'GAYGAYgay',{'expiresIn':_0x20dc66(0x1d7)}),{passwordHash:_0x2349e5,..._0x4d0fa3}=_0x4e6c63[_0x20dc66(0x1d2)];_0x3c32fe[_0x20dc66(0x1d8)]({..._0x4d0fa3,'token':_0x111fbd});}catch(_0x1e5a1d){console[_0x20dc66(0x1d9)](_0x1e5a1d),_0x3c32fe[_0x20dc66(0x1ce)](0x1f4)[_0x20dc66(0x1d8)]({'message':_0x20dc66(0x1d5)});}};export const login=async(_0x2ce90c,_0x287a83)=>{const _0x571fe8=_0x1354;try{const _0x12f710=await _0x4fa4d3[_0x571fe8(0x1d6)]({'userName':_0x2ce90c[_0x571fe8(0x1e0)][_0x571fe8(0x1e7)]});if(!_0x12f710)return _0x287a83[_0x571fe8(0x1ce)](0x194)[_0x571fe8(0x1d8)]({'message':_0x571fe8(0x1e8)});const _0x4487a0=await _0x1c5f0a[_0x571fe8(0x1cf)](_0x2ce90c[_0x571fe8(0x1e0)][_0x571fe8(0x1cb)],_0x12f710['_doc'][_0x571fe8(0x1d3)]);if(!_0x4487a0)return _0x287a83['status'](0x190)['json']({'message':_0x571fe8(0x1da)});const _0x1f733c=_0x5ae0c4[_0x571fe8(0x1c9)]({'_id':_0x12f710[_0x571fe8(0x1ea)],'username':_0x12f710[_0x571fe8(0x1e7)]},'GAYGAYgay',{'expiresIn':_0x571fe8(0x1d7)}),{passwordHash:_0x36143e,..._0x24cbac}=_0x12f710[_0x571fe8(0x1d2)];_0x287a83[_0x571fe8(0x1d8)]({..._0x24cbac,'token':_0x1f733c});}catch(_0xa613b5){console[_0x571fe8(0x1d9)](_0xa613b5),_0x287a83[_0x571fe8(0x1ce)](0x1f4)[_0x571fe8(0x1d8)]({'message':_0x571fe8(0x1e3)});}};export const getMe=async(_0x50dcc3,_0x173558)=>{const _0x2946fe=_0x1354;try{const _0x2736ae=await _0x4fa4d3[_0x2946fe(0x1d0)](_0x50dcc3[_0x2946fe(0x1de)]);if(!_0x2736ae)return _0x173558['status'](0x194)[_0x2946fe(0x1d8)]({'message':_0x2946fe(0x1eb)});const {passwordHash:_0x191042,..._0x2e71d6}=_0x2736ae[_0x2946fe(0x1d2)];_0x173558[_0x2946fe(0x1d8)]({..._0x2e71d6});}catch(_0x2417dd){console[_0x2946fe(0x1d9)](_0x2417dd);}};export const editStatus=async(_0x18af1c,_0x25c4a5)=>{const _0x5a18a4=_0x1354;try{const _0x41061f=_0x18af1c['params']['id'];await _0x4fa4d3[_0x5a18a4(0x1db)]({'_id':_0x41061f},{'status':_0x18af1c[_0x5a18a4(0x1e0)]['status']}),_0x25c4a5[_0x5a18a4(0x1d8)]({'success':!![]});}catch(_0x1b55f9){console[_0x5a18a4(0x1d9)](_0x1b55f9),_0x25c4a5[_0x5a18a4(0x1ce)](0x1f4)[_0x5a18a4(0x1d8)]({'message':'Не\x20удалось\x20обновить\x20статус'});}};